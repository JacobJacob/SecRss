# SecRss
![miao](http://mweb.03sec.com/2018-01-29-timg.jpeg)

## ä»€ä¹ˆæ˜¯SecRssï¼Ÿ
- å°†rssæºæ¯å¤©æ›´æ–°çš„æ–‡ç« ä¿å­˜åˆ°æœ¬åœ°
- å°†rssæºæ¯å¤©æ›´æ–°çš„æ–‡ç« é€šè¿‡å¹³å°æ¨é€ç»™ç”¨æˆ·
- â€¦â€¦

## ç¯å¢ƒè¦æ±‚ï¼š
- python3
- mysql

### é…ç½®è¿è¡Œç¯å¢ƒ
1. ä¸‹è½½ä»£ç 

```
git clone https://github.com/anbai-inc/SecRss.git
```

2. å®‰è£…ä¾èµ–ç¯å¢ƒ

```
pip3 install -r requirements.txt
```

3. æ›´æ”¹é…ç½®æ–‡ä»¶

é…ç½®æ–‡ä»¶ä½äº`config`ç›®å½•ä¸‹çš„`news.cfg`æ–‡ä»¶
#### é…ç½®æ–‡ä»¶å­—æ®µè§£é‡Š
- database
æ•°æ®åº“é…ç½®ï¼Œå…·ä½“çš„å°±ä¸ç”¨è¯´äº†å§ï¼Ÿ
- server
é™æ€æœåŠ¡å™¨çš„urlé…ç½®ï¼Œä¹Ÿå¯ä»¥æ˜¯æœ¬åœ°çš„è·¯å¾„ï¼Œæœ€åæ˜¯è¦å±•ç°åœ¨ç½‘é¡µé‡Œé¢çš„ï¼Œç¡®ä¿ä½ ç½‘é¡µé‡Œé¢çš„å›¾ç‰‡èƒ½æ­£å¸¸åŠ è½½å‡ºæ¥å³å¯ï¼ˆå¦‚æœä½ æœ‰ç½‘ç«™å±•ç¤ºçš„éœ€è¦ï¼Œå¯ä»¥å°†æœ¬é¡¹ç›®ä¸‹çš„staticç›®å½•ä½¿ç”¨è½¯è¿æ¥çš„æ–¹å¼è¿›è¡Œæ­å–œä¸€ä¸ªç›®å½•ï¼‰
- picBlacklist
ä¸‹è½½å›¾ç‰‡é»‘åå•ï¼Œç”¨`,`å·åˆ†å‰²

## å¹³å°ç¼–å†™

### ç¼–å†™ä¸€ä¸ªæ’ä»¶éœ€è¦æŒ‰ç…§ä»¥ä¸‹çš„æ ¼å¼è¿›è¡Œç¼–å†™

```
class Platform(Base):
    def __init__(self, news_list):
        super(Platform, self).__init__(news_list)
        self.info = {
            "name": "xxx", # å¹³å°åå­—ï¼Œéœ€è¦ä¸æ–‡ä»¶åä¸€è‡´
            "status": True, # å¹³å°æ˜¯å¦å¯ç”¨
            "save": True, # æ˜¯å¦å­˜å…¥æ•°æ®åº“
            "images": True, # æ˜¯å¦ä¸‹è½½å›¾ç‰‡
        }

    def push_message(self):
        """
        æ¨é€æ¶ˆæ¯éƒ¨åˆ†ä»£ç 
        :return Boolean:
        """
        pass
```
### æ³¨æ„äº‹é¡¹
- ç±»åå­—å¿…é¡»ä¸º`Platform`,ä¸”å¿…é¡»å®ç°`Base`åŸºç¡€ç±»
- `__init__`æ–¹æ³•é‡Œé¢çš„`info`å¿…é¡»æŒ‰ç…§æ ¼å¼å»å†™ï¼Œå¯ä»¥æ·»åŠ ï¼Œä¸å¯ä»¥**åˆ é™¤**
- `push_message`æ–¹æ³•éœ€è¿›è¡Œé‡å†™ï¼Œæ–¹ä¾¿å¯¹æ¶ˆæ¯å¹³å°æ¨é€æ¶ˆæ¯ï¼Œæœ€åè¿”å›çš„ç±»å‹å¿…é¡»æ˜¯Booleanç±»å‹
- å¦‚æœå‘ç°åŸºç¡€ç±»é‡Œé¢çš„æŸä¸ªæ–¹æ³•ä¸é€‚ç”¨ä¸æŸä¸ªæ’ä»¶ï¼Œå¯ä»¥å¯¹å…¶è¿›è¡Œé‡å†™

## rssè®¢é˜…è§„åˆ™æºç¼–å†™
ä¸€æ¡å®Œæ•´çš„rssè§„åˆ™ï¼Œä¸¾ä¸ªğŸŒ°ï¼š

```
{
    "name": "evi1cg",
    "s_title": "evi1cg",
    "rss": "https://evi1cg.me/feed",
    "has_content": "",
    "start_str": "<section class=\"post-main-section\">",
    "end_str": "<div class=\"post-tags\">",
    "language": "zh-cn",
    "lazyLoading":true,
    "lazyLabel":"data-original"
}
```
### å„ä¸ªå­—æ®µè¯´æ˜

| å­—æ®µå | æè¿° |
| --- | --- |
| name | åå­— |
| s_title | å…¥åº“æ—¶å€™ä¿å­˜çš„åå­— |
| rss | rssè®¢é˜…åœ°å€ |
| has_content | é‡‡é›†çš„å†…å®¹æ˜¯å¦åŒ…å«xxxï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™ç›´æ¥è¿›è¡Œé‡‡é›† |
| start_str | é‡‡é›†æ–‡ç« å¼€å§‹çš„ä½ç½®ï¼Œhtmlæ ‡ç­¾å»è¡¨ç¤º |
| end_str | é‡‡é›†æ–‡ç« ç»“æŸçš„ä½ç½®ï¼Œhtmlæ ‡ç­¾å»è¡¨ç¤º |
| language | ç½‘ç«™è¯­è¨€ç±»å‹ |
| lazyLoading | å›¾ç‰‡æ˜¯å¦ä¸ºæ‡’åŠ è½½ |
| lazyLabel | å›¾ç‰‡æ‡’åŠ è½½æ ‡ç­¾é‡Œé¢çœŸå®çš„å›¾ç‰‡åœ°å€ |


## å®šæ˜¯é‡‡é›†è®¾ç½®ï¼ˆé€‚ç”¨äºlinuxï¼‰
1. åœ¨/var/ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª`run.sh`ï¼Œè¾“å…¥ä»¥ä¸‹ä»£ç ï¼Œè®°ä½æ›´æ”¹ä»£ç çš„ç»å¯¹è·¯å¾„

```
/usr/bin/python3 /var/sec-news/current/run_news.py >>/var/log.log
```
2. åœ¨linuxä¸‹è¾“å…¥`crontab -e`ï¼Œå»ºç«‹ä»¥ä¸‹è§„åˆ™:

```
29 18 * * * /var/run.sh
```
è¯¥è§„åˆ™çš„æ„æ€ä¸ºæ¯å¤©18ç‚¹29åˆ†è¿è¡Œ`var`ç›®å½•ä¸‹é¢çš„`run.sh`(æˆ‘ä»¬ä¸Šé¢ä¿å­˜run.shçš„è·¯å¾„)



